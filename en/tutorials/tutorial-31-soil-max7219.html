<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="pragma" content="no-cache"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> <meta name="author" content="webduino.io"> <meta name="copyright" content="webduino.io"> <meta itemprop="name" content="webduino.io"> <link rel="icon" href="../../img/layout/favicon.ico" type="image/x-icon"> <title>Project Example 31: Visualizing soil moisture with an LED matrix :::: Webduino = Web × Arduino</title> <meta name="description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image."> <meta itemprop="description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image."> <meta property="og:description" content="Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image."> <meta property="og:title" content="Project Example 31: Visualizing soil moisture with an LED matrix"> <meta property="og:url" content="https://webduino.io/tutorials/tutorial-31-soil-max7219.html"> <meta property="og:image" content="https://webduino.io/img/tutorials/tutorial-31-01s.jpg"> <meta itemprop="image" content="https://webduino.io/img/tutorials/tutorial-31-01s.jpg"> <script src="../../js/lib/jquery.min.js"></script> <script src="../../js/lib/jquery.lazyload.min.js"></script> <script src="../../js/lib/run_prettify.js"></script> <script src="../../js/layout.js"></script> <script src="../../js/tutorials-en.js"></script> <script src="../../js/lib/disqus.js"></script> <link rel="stylesheet" href="../../style/css/lib/tomorrow.css"> <link rel="stylesheet" href="../../style/css/layout.css"> <link rel="stylesheet" href="../../style/css/sub-header.css"> <link rel="stylesheet" href="../../style/css/tutorials-content.css"> <link rel="stylesheet" href="../../style/css/tutorials-en-content.css"> <link rel="stylesheet" href="../../style/css/lib/font-awesome.css"> <style>
.tutorials-content p{
	word-wrap:normal;
	word-break:normal;
}
</style> </head> <body> <header class="path-0"> <a class="logo" href="index.html" data-name="layout-header-logo"></a> <div class="mobile-menu"></div> <div class="menu"> <a href="index.html" class="index" data-name="layout-mobile-menu">Home</a> <a href="tutorials.html" class="tutorials" data-name="layout-mobile-menu">Tutorials</a> <a href="buy.html" class="buy" data-name="layout-mobile-men">Buy</a> <a href="about.html" class="about" data-name="layout-mobile-men">About us</a> <a href="../index.html" class="english" data-name="layout-mobile-men">中文</a> </div> </header> <header class="path-1"> <a class="logo" href="../index.html"></a> <div class="mobile-menu"></div> <div class="menu"> <a href="../index.html" class="index" data-name="layout-menu">Home</a> <a href="../tutorials.html" class="tutorials" data-name="layout-menu">Tutorials</a> <a href="../buy.html" class="buy" data-name="layout-menu">Buy</a> <a href="../about.html" class="about" data-name="layout-menu">About us</a> <a href="../../index.html" class="english" data-name="layout-mobile-men">中文</a> </div> </header> <div class="tutorials-content"> <div class="banner"> </div> <h1 id="project-example-31-visualizing-soil-moisture-with-an-led-matrix">Project Example 31: Visualizing soil moisture with an LED matrix</h1> <p>Using the electric conductivity between two metal pieces, we can use a soil moisture sensor to measure the approximate dampness of soil. In this example, we will be making a visualization of the water measured and when the moisture levels are higher than 100 it will automatically play an animated image. </p>  <h2 id="video-tutorial">Video Tutorial</h2> <p>Watch the video tutorial here: </p> <iframe class="youtube" src="https://www.youtube.com/embed/ppweeGJD0nw" frameborder="0" allowfullscreen=""></iframe> <h2 id="wiring-and-practice">Wiring and Practice</h2> <p>The Soil Moisture Sensor has 3 pins, SIG, GND and VCC. Since we will be using an LED matrix to show the values, the LED matrix will also be using the GND and VCC. So, we will need to use a breadboard to make everything fit. Connect VCC to VCC, GND to GND, SIG from the soil moisture sensor to A3. For the LED matrix, connect DIN to 7, CS to 8, and CLK to 9.</p> <p>Webduino Mark 1 Circuit Diagram:</p> <p><img src="../../img/tutorials/tutorial-31-02.jpg"></p> <p>Webduino Fly Circuit Diagram:</p> <p><img src="../../img/tutorials/tutorial-31-02-fly.jpg"></p> <p>Reference image:</p> <p><img src="../../img/tutorials/tutorial-31-03.jpg"></p> <p><img src="../../img/tutorials/tutorial-31-04.jpg"></p> <p><img src="../../img/tutorials/tutorial-31-05.jpg"></p> <p><img src="../../img/tutorials/tutorial-31-06.jpg"></p>  <h2 id="instructions-for-using-the-webduino-blockly">Instructions for using the Webduino Blockly</h2> <p>Open the <a href="https://blockly.webduino.io/?lang=en">Webduino Blockly Editor</a>, place a &quot;Board&quot; block into the workspace and fill in the name of the Webduino board you are using. Then place the &quot;Soil Moisture&quot; block from &quot;Sensors&quot; and the &quot;LED Matrix&quot; from &quot;Components&quot; inside and assign the correct pins to each of them.</p> <p><img src="../../img/tutorials/en/tutorial-31-07.jpg"></p> <p>Place a &quot;Soil Detects&quot; block into the stack using a variable representing the value currently measured, we also round this value to a whole number. We will be using this value repeatedly, so using the same variable allows us to change less code. We must round to a whole number because the LED matrix can only shows integers.</p> <p><img src="../../img/tutorials/en/tutorial-31-08.jpg"></p> <p>Then place a &quot;Show&quot; block from &quot;Show Text&quot; into the stack, so the measured value will simultaneously show on the &quot;Web Demo Area&quot; as well. Then add an &quot;If, do, else&quot; &quot;Logic&quot; block and connect the necessary &quot;Logic&quot;, &quot;Variable&quot;, &quot;LED Matrix&quot;, and &quot;Math&quot; blocks to the stack. When the values are less than 100, it will show the number on the LED matrix and when it is greater than or equal to 100, an animated image will play.</p> <p><img src="../../img/tutorials/en/tutorial-31-09.jpg"></p> <p>We&#39;ve finished most of the hard work, check if the board is online (click <a href="https://webduino.io/device.html">Check Device Status</a>) and click on the red execution button &quot;Run Blocks&quot;. If you take a glass of water and place the soil moisture sensor inside the water, you will see the values change. Solution: <a href="https://blockly.webduino.io/?lang=en#-KYlgaaXx61FlgO19A9h">https://blockly.webduino.io/?lang=en#-KYlgaaXx61FlgO19A9h</a></p> <p>Be aware that different sensors will have different readings. Also if we connect VCC to 3.3V, the MAX value will also be different. If the values need to be converted, the &quot;Scale conversion&quot; block can be used as seen in these images.</p> <p><img src="../../img/tutorials/en/tutorial-31-10.jpg"></p> <p><img src="../../img/tutorials/en/tutorial-31-11.jpg"></p> <p>##Code Explanation (<a href="https://bin.webduino.io/fijuw/edit?html,css,js,output">Check Webduino Bin</a>, <a href="https://webduino.io/device.html">Check Device Status</a>)</p> <p>Include <code>webduino-all.min.js</code> in the header of your html files in order to support all of the Webduino&#39;s components. If the codes are generated by Webduino Blockly, you also have to include <code>webduino-blockly.js</code> in your files.</p> <pre><code>&lt;script src=&quot;https://webduino.io/components/webduino-js/dist/webduino-all.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://webduinoio.github.io/webduino-blockly/webduino-blockly.js&quot;&gt;&lt;/script&gt;
</code></pre><p>The first half of the code inside JavaScript are for the LED matrix to show images, the second half is for detection and measuring, we mainly use <code>on</code> to measure and it returns <code>val</code>.</p> <pre><code>boardReady(&#39;&#39;, function (board) {
  board.systemReset();
  board.samplingInterval = 250;
  soil = getSoil(board, 3);
  matrix = getMax7219(board, 7, 8, 9);
  soil.on(function(val){
    soil.detectedVal = val;
    a = Math.round(soil.detectedVal);
    document.getElementById(&quot;demo-area-01-show&quot;).innerHTML = a;
    if (a &lt; 100) {
      matrix.animateStop();
      matrix.on(&quot;0000000000000000&quot;);
      matrix.on((max7219_number(a)));
    } else {
      matrix.animateStop();
      matrix.animate(max7219_horse(&quot;left&quot;,&quot;0c1e3e7c3e1e0c00&quot;),100);
    }
  });
});
</code></pre><p>This is how you can visualize soil moisture with an LED matrix!<br>Webduino Bin: <a href="https://bin.webduino.io/fijuw/edit?html,css,js,output">https://bin.webduino.io/fijuw/edit?html,css,js,output</a><br>Stack setup: <a href="https://blockly.webduino.io/?lang=en#-KYlgkLyhokqWK8p5WQh">https://blockly.webduino.io/?lang=en#-KYlgkLyhokqWK8p5WQh</a></p>  <a class="arrow arrow-r pre-next-button" data-name="pre-next-arrow"></a> <a class="arrow arrow-l pre-next-button" data-name="pre-next-arrow"></a> <div class="pre-next"> <div> <div class="pre"></div> <div class="next"></div> </div> </div> <div class="note-chicken"></div> <div class="others"> <i class="fa fa-times note-close-btn"></i> <h5>More information : </h5> <div class="others-link otehrs-read"> 1. Tutorials : <a href="https://webduino.io/en/tutorials.html" data-name="noteLink">https://webduino.io/tutorials.html</a> <br> 2. Blockly : <a href="https://goo.gl/Y8sRkl" data-name="noteLink">https://goo.gl/Y8sRkl</a> <br> 3. Products : <a href="https://webduino.io/buy.html" target="_blank" data-name="noteLink">https://webduino.io/buy.html <i class="fa fa-share-square-o"></i></a> <br> 4. Store : <a href="http://goo.gl/0Dj9ip" target="_blank" data-name="noteLink">http://goo.gl/0Dj9ip <i class="fa fa-share-square-o"></i></a> </div> </div> </div> <div class="disqus"> <div id="disqus_thread"></div> </div> <footer class="en"> <div class="logo"> <a href="index.html" data-name="layout-footer-logo"><i></i></a> <a href="../index.html" data-name="layout-footer-logo"><i></i></a> </div> <h4>Copyright 2017 | All Rights Reserved. Powered by Webduino</h4> <h4 style="padding-bottom: 20px;">2F-6, No.12, Fuxing 4th Rd., Qianzhen Dist., Kaohsiung City 806, Taiwan (R.O.C.) / 886-7-3388511</h4> </footer> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62202920-1', 'auto');
  ga('send', 'pageview');

</script> </body> </html>