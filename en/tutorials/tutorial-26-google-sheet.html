<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="pragma" content="no-cache"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> <meta name="author" content="webduino.io"> <meta name="copyright" content="webduino.io"> <meta itemprop="name" content="webduino.io"> <link rel="icon" href="../../img/layout/favicon.ico" type="image/x-icon"> <title>Project Example 26: Controlling an LED with Google Sheets :::: Webduino = Web × Arduino</title> <meta name="description" content="Google Sheets is a commonly used online service from Google, offering full spreadsheet capabilities. It can be used with Google Forms, acting as a database for your survey answers. In this tutorial, we will fill a Google Form, average and round off the results, then show the information through a number of LEDs."> <meta itemprop="description" content="Google Sheets is a commonly used online service from Google, offering full spreadsheet capabilities. It can be used with Google Forms, acting as a database for your survey answers. In this tutorial, we will fill a Google Form, average and round off the results, then show the information through a number of LEDs."> <meta property="og:description" content="Google Sheets is a commonly used online service from Google, offering full spreadsheet capabilities. It can be used with Google Forms, acting as a database for your survey answers. In this tutorial, we will fill a Google Form, average and round off the results, then show the information through a number of LEDs."> <meta property="og:title" content="Project Example 26: Controlling an LED with Google Sheets"> <meta property="og:url" content="https://webduino.io/tutorials/tutorial-26-google-sheet.html"> <meta property="og:image" content="https://webduino.io/img/tutorials/tutorial-26-01s.jpg"> <meta itemprop="image" content="https://webduino.io/img/tutorials/tutorial-26-01s.jpg"> <script src="../../js/lib/jquery.min.js"></script> <script src="../../js/lib/jquery.lazyload.min.js"></script> <script src="../../js/lib/run_prettify.js"></script> <script src="../../js/layout.js"></script> <script src="../../js/tutorials-en.js"></script> <script src="../../js/lib/disqus.js"></script> <link rel="stylesheet" href="../../style/css/lib/tomorrow.css"> <link rel="stylesheet" href="../../style/css/layout.css"> <link rel="stylesheet" href="../../style/css/sub-header.css"> <link rel="stylesheet" href="../../style/css/tutorials-content.css"> <link rel="stylesheet" href="../../style/css/tutorials-en-content.css"> <link rel="stylesheet" href="../../style/css/lib/font-awesome.css"> <style>
.tutorials-content p{
	word-wrap:normal;
	word-break:normal;
}
</style> </head> <body> <header class="path-0"> <a class="logo" href="index.html" data-name="layout-header-logo"></a> <div class="mobile-menu"></div> <div class="menu"> <a href="index.html" class="index" data-name="layout-mobile-menu">Home</a> <a href="tutorials.html" class="tutorials" data-name="layout-mobile-menu">Tutorials</a> <a href="buy.html" class="buy" data-name="layout-mobile-men">Buy</a> <a href="about.html" class="about" data-name="layout-mobile-men">About us</a> <a href="../index.html" class="english" data-name="layout-mobile-men">中文</a> </div> </header> <header class="path-1"> <a class="logo" href="../index.html"></a> <div class="mobile-menu"></div> <div class="menu"> <a href="../index.html" class="index" data-name="layout-menu">Home</a> <a href="../tutorials.html" class="tutorials" data-name="layout-menu">Tutorials</a> <a href="../buy.html" class="buy" data-name="layout-menu">Buy</a> <a href="../about.html" class="about" data-name="layout-menu">About us</a> <a href="../../index.html" class="english" data-name="layout-mobile-men">中文</a> </div> </header> <div class="tutorials-content"> <div class="banner"> </div> <h1 id="project-example-26-controlling-an-led-with-google-sheets">Project Example 26: Controlling an LED with Google Sheets</h1> <p>Google Sheets is a commonly used online service from Google, offering full spreadsheet capabilities. It can be used with Google Forms, acting as a database for your survey answers. In this tutorial, we will fill a Google Form, average and round off the results, then show the information through a number of LEDs.</p>  <h2 id="video-tutorial">Video Tutorial</h2> <p>Check the video tutorial here: </p> <iframe class="youtube" src="https://www.youtube.com/embed/mpwSAFwlL_0" frameborder="0" allowfullscreen=""></iframe> <h2 id="wiring-and-practice">Wiring and Practice</h2> <p>We will only be using 7 LEDs for this tutorial, one LED each for a score of 1 - 7. Connect the LEDs with solid wire and a breadboard, connecting the longer legs to pin 7, 8, 9, 10, 11, 12, 13 and the shorter legs to GND.</p> <p>Circuit diagram:</p> <p><img src="../../img/tutorials/tutorial-26-02.jpg"></p> <p>Reference image:</p> <p><img src="../../img/tutorials/tutorial-26-03.jpg"></p> <p><img src="../../img/tutorials/tutorial-26-04.jpg"></p> <p><img src="../../img/tutorials/tutorial-26-05.jpg"></p>  <h2 id="instructions">Instructions</h2> <p>Since we will be using Google Forms, you will need to have a Google Drive account. Start by selecting &quot;NEW&quot; to open a new Folder or directly open a new Google Form file. In this tutorial we&#39;ve created a Folder named &quot;test&quot; to keep all of our forms and sheets.</p> <p><img src="../../img/tutorials/en/tutorial-26-06.jpg"></p> <p>Open the Form, type in a name for the Form (later on, an automatically generated spreadsheet will share the same name), click on the &quot;Responses&quot; tab and click on &quot;Create Spreadsheet&quot; to create a spreadsheet that is linked to this Form.</p> <p><img src="../../img/tutorials/en/tutorial-26-07.jpg"></p> <p>Now, click on the &quot;Questions&quot; tab, here we can add a few questions for our survey. Let&#39;s create a &quot;Linear Scale&quot; question, set 1 to 7, so when a user chooses a number, Google Sheets will record the selection.</p> <p><img src="../../img/tutorials/en/tutorial-26-08.jpg"></p> <p>Click on the &quot;eye&quot; icon on the upper-right hand side to preview, select 7 and click &quot;submit&quot;.</p> <p><img src="../../img/tutorials/en/tutorial-26-09.jpg"></p> <p>Once you&#39;ve done that, return to Google Drive, find the matching Google Sheet and open it.</p> <p><img src="../../img/tutorials/en/tutorial-26-10.jpg"></p> <p>The first column records the &quot;timestamp&quot;, indicating when the answer was recorded and the second column shows the number recorded.</p> <p><img src="../../img/tutorials/en/tutorial-26-11.jpg"></p> <p>To calculate the average, type &quot;Average&quot; in C1 and then type the formula from the picture below into D1.</p> <p><img src="../../img/tutorials/en/tutorial-26-12.jpg"></p> <p>Use the formula below for calculations</p> <pre><code>=IF(TYPE(ROUND(AVERAGE(B:B)))=16,0,ROUND(AVERAGE(B:B)))
</code></pre><p>Then type in the Device name of the board we are using in cell E1.</p> <p><img src="../../img/tutorials/en/tutorial-26-13.jpg"></p> <p>Now for <strong>the most important</strong> part; select &quot;Tools&quot; &gt; &quot;Script Editor&quot; which will open a new page with the developer tools for this spreadsheet, then type in the code provided below. This piece of code will control the LEDs to light up according to the average scores from the spreadsheet.</p> <p><img src="../../img/tutorials/en/tutorial-26-14.jpg"></p> <pre><code>function myFunction() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var device = sheet.getRange(&#39;E1&#39;).getValue();
  var a = sheet.getRange(&#39;D1&#39;).getValue();
  led(device,a);
}

function led(d,r){
  for(var i=7; i&lt;=13; i++){
    setPin(d,i,0);
    if(i==13){
      for(var j=0; j&lt;r; j++){
        setPin(d,13-j,1);
      }
    }
  }
}

function setPin(id,pin,state){
   var response = UrlFetchApp.fetch(&quot;http://webduino.tw/iot/&quot;+id+&quot;/set/&quot;+pin+&quot;/&quot;+state);
}
</code></pre><p>After you&#39;ve typed in all of the code correctly, click &quot;Resources&quot; &gt; &quot;All your triggers&quot;, enter a new project name when prompted and press &quot;ok&quot;. If you are asked to &quot;authorize&quot; following actions, click ok. Then click &quot;No triggers set up, click here to add one now&quot;.</p> <p><img src="../../img/tutorials/en/tutorial-26-15.jpg"></p> <p>To &quot;Run&quot; your piece of code when the spreadsheet has changes, you have to create two triggers. For the first trigger set &quot;Events&quot; to &quot;From spreadsheet&quot; and &quot;On change&quot; and for the second set &quot;Events&quot; to &quot;From spreadsheet&quot; and &quot;On form submit&quot;. So then, when an user fills out the spreadsheet and submits it, your code will run.</p> <p><img src="../../img/tutorials/en/tutorial-26-16.jpg"></p> <p>Now for the very last step, fill in the &quot;Device&quot; name of your board on cell E1, check if your board is online (you can check here: <a href="https://webduino.io/device.html">https://webduino.io/device.html</a> ), fill in the Form and submit it. You will see the number of LEDs light up correspond with the numbers that are filled in.</p>  <a class="arrow arrow-r pre-next-button" data-name="pre-next-arrow"></a> <a class="arrow arrow-l pre-next-button" data-name="pre-next-arrow"></a> <div class="pre-next"> <div> <div class="pre"></div> <div class="next"></div> </div> </div> <div class="note-chicken"></div> <div class="others"> <i class="fa fa-times note-close-btn"></i> <h5>More information : </h5> <div class="others-link otehrs-read"> 1. Tutorials : <a href="https://webduino.io/en/tutorials.html" data-name="noteLink">https://webduino.io/tutorials.html</a> <br> 2. Blockly : <a href="https://goo.gl/Y8sRkl" data-name="noteLink">https://goo.gl/Y8sRkl</a> <br> 3. Products : <a href="https://webduino.io/buy.html" target="_blank" data-name="noteLink">https://webduino.io/buy.html <i class="fa fa-share-square-o"></i></a> <br> 4. Store : <a href="http://goo.gl/0Dj9ip" target="_blank" data-name="noteLink">http://goo.gl/0Dj9ip <i class="fa fa-share-square-o"></i></a> </div> </div> </div> <div class="disqus"> <div id="disqus_thread"></div> </div> <footer class="en"> <div class="logo"> <a href="index.html" data-name="layout-footer-logo"><i></i></a> <a href="../index.html" data-name="layout-footer-logo"><i></i></a> </div> <h4>Copyright 2017 | All Rights Reserved. Powered by Webduino</h4> <h4 style="padding-bottom: 20px;">2F-6, No.12, Fuxing 4th Rd., Qianzhen Dist., Kaohsiung City 806, Taiwan (R.O.C.) / 886-7-3388511</h4> </footer> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62202920-1', 'auto');
  ga('send', 'pageview');

</script> </body> </html>